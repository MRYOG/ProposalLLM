# ProposalLLM
标书大模型（Proposal-LLM Chinese version )

本开源软件实现功能：
1. 根据需求对应表，自动根据产品文档生成点对点应答格式的标书，包括所有小标题及内容，自动生成标题1,2,3格式，自动整理正文、图片、项目符号格式
2. 标书内容如果有产品需求对应表中对应功能，自动拷贝产品说明书内容到点对点应答之后（保留图片、表格，项目符号等），也可以自动重写产品文字内容以面对不同标书需求；如果无对应功能，会调用大模型自动生成相关功能说明
3. 完成技术需求偏离对应表，自动填写需求对应表当中点对点应答，格式为“答：全面支持，{大模型根据需求自动生成文本}”，同时填写标书对应的章节号码
4. 拆解产品功能手册为可复用的若干可复用的细节文档，用于书写标书不用反复扫描原文档，提高生成标书性能，也可以针对不同功能进行修改


使用说明：
1. 安装python环境，安装相关包：pip install openpyxl,docx,openai,requests,docx,python-docx
2. 申请ChatGPT或者 百度千帆大模型（我使用的是ERNIE-Speed-8K，免费模型），申请后把Token记录下来，填写到代码当中相应key的位置
3. 拷贝产品说明手册到Template.docx，注意，样式需要用文档中的正文，标题1，标题2，标题3，其它格式可能会出现问题
4. 运行Extract_Word.py 生成产品手册对应的文档文件（目前支持最多3级标题），检查生成文件内容是不是正确，此时项目列表格式如果不对不要紧，最后生成格式为准。
5. 填写需求对应表.xlsx，当中的B列，C列（程序自动根据这个内容会生成二级、三级标题），G列（对应产品说明书当中的功能章节，如果没有可以填X，注意目前支持到3级标题，填X或者找不到章节的部分，大模型会自动生成内容）
6. 检查“标书内容 .docx",保留准备要生成标书开始的章节，所有正文、标题1，2，3的样式，可以自行修改样式格式，不要改样式名称，否则生成样式会找不而报错
7. 设置Generate.py里面的参数
   1） openai.api_key：openAI的Key
   
   2） API_KEY，SECRET_KEY 百度的Key
   3） MAX_WIDTH_CM，图片最大宽度，大于此宽度会自动缩小
   4） 各种自动生成点对点应答和内容的的Prompt，已经根据大数据场景进行修改了，可以根据产品类型，自行修改，点对点应答格式也可以自己定义。
   5） MoreSection=1会读取C列，生成明细三级标题，默认1开启
   6） ReGenerateText=0，如果为1，会把所有产品文档文字部分自动重新生成，用于面对不同标书需求，默认为0
   7） DDDAnswer=1，如果为1，自动生成点对点应答内容放到每个功能点的头部位置，默认为1
   8） key_flag=1,会带需求重要程度到标书小标题当中，默认开启
   9） last_heading_1=2 ，在标书内容.docx当中 生成技术方案的 开始章节，例如模板当中的，开始章节就是2，这样可以在需求对应表当中自动填写对应章节号。
9. 运行Generate.py

最后做一个广告，白鲸开源是ApacheDolphinScheduler和ApacheSeaTunnel原班人马成立的开源商业公司，提供功能更强多、稳定性更强的商业版本解决用户调度，数据开发、数据同步和ETL的问题，目前支持192种数据库的ETL与数据开发，全面替换Informatica与Talend等工具相应功能，在中信证券、中信建投、中国银行、中国人保、中国人寿、旺旺集团等多个行业头部企业都有成功商业版和实施替换案例。
WhaleStudio是一款通过拖拽式的实现调度和ETL功能，支持快速融合在企业/合作伙伴的系统当中，感兴趣直接发邮件给service@whaleops.com。
